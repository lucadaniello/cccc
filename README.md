
<!-- README.md is generated from README.Rmd. Please edit that file -->

``` r
library(cccc)
#> cccc package
```

``` r
data <- importData(tdm_file = "data-raw/JPSP_TITfreq.csv",
                   corpus_file = "data-raw/JPSP_TITinfo.csv",
                   sep_tdm = ";",
                   sep_corpus_info = ";",
                   zone="stat")
#> There are 0 missing values in the tdm.
```

``` r
rowMass <- rowMassPlot(data = data)
rowMass
```

<img src="man/figures/README-unnamed-chunk-4-1.png" width="100%" />

``` r
colMass <- colMassPlot(data = data,
                         sc = c(1, 10, 10, 1),
                         r = 1,
                         textty = "text",
                         themety = "light",
                         size_b = 2.5,
                         x_lab = "years")
colMass
```

<img src="man/figures/README-unnamed-chunk-5-1.png" width="100%" />

``` r
curve <- curvePlot(data = data,
                   r = 1,
                   themety = "light",
                   size_class = NULL,
                   x_leg = 0.85,
                   x_lab = "years"
)
curve
```

<img src="man/figures/README-unnamed-chunk-6-1.png" width="100%" />

``` r
curveCtu <- curveCtuPlot(data,
                         ctu_noun = c("person", "object", "instruct", "incident"),
                         r = 1,
                         themety = "light",
                         size_class = NULL,
                         x_lab = "year")
curveCtu
```

<img src="man/figures/README-unnamed-chunk-7-1.png" width="100%" />

``` r
## Normalize columns by corpus size
data_nc <- normalization(data, normty = "nc", sc = 1000)
head(data_nc$tdm, n=10)
#>     keyword tot_freq  int_freq zone      1965      1966      1967      1968
#> 1    effect     1528 [49-1528]   VH 19.198664 19.131334 17.160686 24.664879
#> 2    person      851 [49-1528]   VH  4.173623  9.307135  7.800312  4.825737
#> 3  behavior      668 [49-1528]   VH  7.512521  8.273009  5.720229 11.260054
#> 4      self      650 [49-1528]   VH  4.173623  1.551189  2.600104  4.825737
#> 5    social      575 [49-1528]   VH  6.677796  5.170631  7.280291  6.434316
#> 6     group      537 [49-1528]   VH  6.260434  5.687694  4.160166  5.898123
#> 7      role      441 [49-1528]   VH  0.000000  1.551189  1.560062  4.289544
#> 8   respons      428 [49-1528]   VH  5.843072  5.687694  6.760270  6.970509
#> 9     model      399 [49-1528]   VH  1.669449  2.585315  4.160166  3.217158
#> 10   affect      367 [49-1528]   VH  2.504174  2.585315  2.080083  3.217158
#>         1969      1970      1971       1972      1973      1974      1975
#> 1  22.342065 22.727273 28.338136 25.7370145 21.442495 24.500907 23.517382
#> 2   5.392912  6.410256  6.243996  7.0191858  7.309942  5.444646  5.453306
#> 3  10.015408 15.151515  7.684918  9.3589144  6.822612 10.889292  7.157464
#> 4   0.770416  4.079254  1.921230  0.9358914  4.385965  3.176044  1.704158
#> 5   5.392912  2.331002  4.803074  2.8076743  3.411306  4.083485  4.089980
#> 6   3.852080  2.913753  4.803074  3.7435657  4.385965  3.629764  5.794138
#> 7   0.000000  1.165501  2.401537  5.1474029  3.411306  3.176044  2.726653
#> 8   6.933744  6.993007  5.763689  4.6794572  8.284600  4.083485  5.794138
#> 9   4.622496  5.827506  4.803074  6.5512401  1.949318  3.629764  2.726653
#> 10  2.311248  4.662005  3.362152  3.7435657  2.436647  4.537205  2.726653
#>          1976      1977      1978       1979      1980      1981      1982
#> 1  20.0655201 20.540541 19.377163 20.3655352 16.549649 17.013233 11.718750
#> 2   6.1425061  4.324324  2.768166  6.7885117  8.525577  9.451796  9.548611
#> 3   8.1900082 12.972973  5.536332  9.9216710  9.528586  7.088847  9.114583
#> 4   2.0475020  6.486486  2.076125  7.3107050  4.012036  3.780718  4.340278
#> 5   6.1425061  6.486486  4.844291  3.1331593  4.513541  3.308129  5.642361
#> 6   5.3235053  1.081081  3.460208  0.5221932  5.516550  5.671078  2.604167
#> 7   0.8190008  3.243243  4.152249  5.2219321  4.012036  5.198488  2.604167
#> 8   6.1425061  5.405405  8.304498  9.9216710  3.510532  3.780718  5.642361
#> 9   3.6855037  1.081081  7.612457  4.6997389  3.510532  2.835539  3.038194
#> 10  1.6380016  1.081081  2.076125  2.6109661  3.510532  4.725898  5.642361
#>         1983      1984      1985      1986      1987      1988      1989
#> 1  13.518887 14.352047 13.385570 16.342142 12.185215 12.059369 16.533066
#> 2   7.952286  9.708738  8.488410 11.474270 10.154346 10.667904  9.018036
#> 3   5.964215  5.065428  4.897160  7.301808  4.061738  2.319109  4.509018
#> 4   7.952286  6.753905  5.550114  6.954103  6.092608  6.493506  6.012024
#> 5   7.157058  7.176024  4.897160  4.172462  7.717303  5.102041  6.012024
#> 6   2.783300  5.487547  4.570682  3.824757  3.249391  3.246753  2.505010
#> 7   4.771372  4.643309  4.570682  5.910987  5.280260  3.710575  5.511022
#> 8   3.180915  4.643309  3.264773  5.563282  2.843217  1.855288  2.004008
#> 9   4.771372  3.799071  2.938296  2.086231  4.467912  2.319109  4.008016
#> 10  1.988072  4.643309  2.611818  3.824757  3.655565  3.246753  4.509018
#>         1990      1991      1992      1993      1994      1995      1996
#> 1  10.747664 11.751539 13.586957 15.220700 10.335917 10.900474 11.346818
#> 2   8.411215  7.274762  7.065217 12.176560  6.718346  9.478673  8.386778
#> 3   4.205607  5.595971  5.978261  6.088280  7.235142  2.843602  3.453379
#> 4   7.943925  8.393956 10.326087  6.595637  4.134367  8.530806 12.826838
#> 5   4.205607  7.274762  4.347826  3.551497  9.819121  5.687204  5.426739
#> 6   5.607477  3.357583  4.891304  4.058853  4.134367  5.213270  7.400099
#> 7   4.672897  3.357583  4.891304  6.088280  5.167959  4.265403  1.973360
#> 8   2.803738  1.678791  3.804348  4.566210  2.583979  2.369668  1.973360
#> 9   3.738318  7.274762  3.804348  3.044140  4.651163  6.161137  5.426739
#> 10  5.607477  1.678791  5.978261  5.580923  3.100775  2.843602  1.973360
#>        1997      1998      1999      2000      2001     2002      2003
#> 1  9.615385  9.128946 9.8199673  7.950028 10.303688 9.571788  6.226054
#> 2  8.012821  7.227083 3.2733224 11.357183  5.965293 8.060453  5.747126
#> 3  5.208333  4.184100 4.3644299  6.814310  4.880694 3.022670  4.789272
#> 4  7.211538  7.607455 7.0921986  7.382169  8.676790 8.564232 12.452107
#> 5  2.403846  3.423355 5.4555374  4.542873  6.507592 3.526448  5.268199
#> 6  8.012821 10.650437 4.9099836  7.382169  5.965293 6.549118  3.831418
#> 7  6.410256  3.042982 3.8188762  5.678592  5.965293 7.052897  5.268199
#> 8  1.602564  3.803728 0.5455537  1.703578  3.253796 1.511335  1.915709
#> 9  3.605769  3.423355 6.0010911  2.839296  2.711497 4.030227  3.352490
#> 10 3.205128  4.184100 6.0010911  2.839296  2.711497 2.518892  7.183908
#>         2004      2005      2006     2007     2008      2009      2010     2011
#> 1  10.152284 10.467980 10.875476 5.917160 8.399440  7.645260 15.060241 5.260641
#> 2   9.427121  8.004926  8.700381 5.325444 4.199720  9.174312  6.626506 6.217121
#> 3   3.625816  3.078818  2.718869 4.142012 4.199720  5.606524  5.421687 3.825921
#> 4   6.526468  5.541872  7.069059 8.284024 6.532898 10.193680  8.433735 4.782401
#> 5   4.350979  2.463054  3.262643 6.508876 4.199720  5.606524  3.012048 6.217121
#> 6   5.076142  9.236453  5.981512 9.467456 6.066262  5.096840  6.024096 1.434720
#> 7   3.625816  4.926108  4.893964 4.733728 6.532898  6.116208  5.421687 2.391200
#> 8   1.450326  1.847291  5.981512 2.958580 3.733084  1.019368  3.012048 1.912960
#> 9   2.900653  1.231527  2.175095 5.325444 5.599627  3.567788  1.807229 2.391200
#> 10  3.625816  1.847291  3.806417 3.550296 5.132991  1.019368  4.216867 3.347681
#>        2012     2013      2014       2015      2016      2017     2018     2019
#> 1  9.742120 6.389776 6.8493151 11.3257828 3.1128405 5.1132213 6.451613 5.469462
#> 2  5.157593 7.667732 8.9041096  7.3284477 5.4474708 9.4959825 9.925558 9.571559
#> 3  7.449857 7.028754 5.4794521  4.6635576 0.7782101 1.4609204 3.473945 3.190520
#> 4  5.730659 7.667732 8.9041096  2.6648901 2.3346304 1.4609204 4.466501 6.836828
#> 5  5.730659 7.028754 3.4246575  7.9946702 4.6692607 5.1132213 3.473945 5.469462
#> 6  2.292264 3.194888 4.7945205  1.9986676 3.8910506 2.9218408 2.977667 5.013674
#> 7  3.438395 6.389776 0.6849315  1.9986676 4.6692607 0.7304602 2.481390 3.646308
#> 8  5.157593 3.194888 3.4246575  1.3324450 3.8910506 0.0000000 1.488834 2.278943
#> 9  1.719198 2.555911 2.0547945  0.6662225 3.8910506 4.3827611 3.473945 1.823154
#> 10 2.865330 1.916933 2.7397260  2.6648901 2.3346304 0.0000000 2.481390 1.823154
#>        2020     2021
#> 1  7.111111 7.915567
#> 2  3.555556 7.915567
#> 3  3.555556 5.277045
#> 4  1.777778 5.277045
#> 5  8.888889 3.518030
#> 6  4.888889 3.518030
#> 7  2.666667 1.759015
#> 8  2.666667 1.759015
#> 9  1.333333 2.638522
#> 10 1.333333 1.759015
```

``` r
## chi-square type normalization
data_nchi <- normalization(data, normty = "nchi", sc = 1000)
head(data_nchi$tdm, n=10)
#>     keyword tot_freq  int_freq zone       1965       1966       1967      1968
#> 1    effect     1528 [49-1528]   VH 0.20341613 0.18230026 0.16290331 0.2315566
#> 2    person      851 [49-1528]   VH 0.07940016 0.15923989 0.13295388 0.0813459
#> 3  behavior      668 [49-1528]   VH 0.18207359 0.18032355 0.12420971 0.2418051
#> 4      self      650 [49-1528]   VH 0.10395313 0.03474696 0.05802244 0.1065006
#> 5    social      575 [49-1528]   VH 0.18801957 0.13093058 0.18365363 0.1605226
#> 6     group      537 [49-1528]   VH 0.18874171 0.15421525 0.11237120 0.1575582
#> 7      role      441 [49-1528]   VH 0.00000000 0.05121434 0.05131236 0.1395321
#> 8   respons      428 [49-1528]   VH 0.22102184 0.19348970 0.22910729 0.2336266
#> 9     model      399 [49-1528]   VH 0.06773888 0.09434221 0.15123643 0.1156648
#> 10   affect      367 [49-1528]   VH 0.11046790 0.10256823 0.08221163 0.1257500
#>          1969       1970       1971       1972       1973       1974      1975
#> 1  0.17843481 0.20530970 0.28517029 0.26378575 0.20722263 0.24915868 0.2779344
#> 2  0.07733452 0.10397558 0.11282086 0.12917358 0.12684389 0.09941623 0.1157196
#> 3  0.18296660 0.31308706 0.17689646 0.21941461 0.15082017 0.25330303 0.1934904
#> 4  0.01446411 0.08662693 0.04544878 0.02254907 0.09964076 0.07592596 0.0473449
#> 5  0.11445509 0.05595777 0.12844221 0.07647076 0.08760685 0.11035202 0.1284488
#> 6  0.08753881 0.07489692 0.13753123 0.10917613 0.12060799 0.10503192 0.1948459
#> 7  0.00000000 0.03648040 0.08373500 0.18279575 0.11422662 0.11190901 0.1116524
#> 8  0.19769863 0.22553072 0.20706805 0.17122542 0.28583342 0.14825330 0.2444678
#> 9  0.14137847 0.20160223 0.18509843 0.25713852 0.07214313 0.14135875 0.1234052
#> 10 0.07685288 0.17534450 0.14086646 0.15974818 0.09804192 0.19210539 0.1341654
#>          1976       1977       1978       1979       1980       1981       1982
#> 1  0.21896645 0.13789428 0.16125997 0.19392024 0.15863043 0.17173065 0.12098782
#> 2  0.12035567 0.05212504 0.04136398 0.11606350 0.14672877 0.17130463 0.17700861
#> 3  0.20443648 0.19921443 0.10539146 0.21610212 0.20891665 0.16367542 0.21525046
#> 4  0.05252445 0.10236557 0.04061625 0.16364267 0.09040085 0.08971092 0.10533869
#> 5  0.17812639 0.11571760 0.10713271 0.07928030 0.11496630 0.08873580 0.15480207
#> 6  0.16530041 0.02065103 0.08193842 0.01414841 0.15045766 0.16288295 0.07650296
#> 7  0.03096679 0.07543948 0.11973043 0.17228334 0.13324389 0.18181209 0.09315666
#> 8  0.23930531 0.12955144 0.24673421 0.33728087 0.12012964 0.13624321 0.20797007
#> 9  0.15401906 0.02779349 0.24261166 0.17137659 0.12886087 0.10960920 0.12012306
#> 10 0.07442156 0.03021690 0.07193613 0.10351084 0.14009669 0.19861068 0.24253730
#>          1983      1984      1985       1986       1987       1988       1989
#> 1  0.14572036 0.1511666 0.1607015 0.18818093 0.13032944 0.12150009 0.15979577
#> 2  0.15390939 0.1836109 0.1829798 0.23723867 0.19500919 0.19298559 0.15650119
#> 3  0.14705489 0.1220408 0.1344851 0.19232863 0.09937294 0.05344661 0.09968751
#> 4  0.20150291 0.1672272 0.1566372 0.18824253 0.15318722 0.15379467 0.13659745
#> 5  0.20500731 0.2008544 0.1562366 0.12767754 0.21934633 0.13660023 0.15441451
#> 6  0.08536669 0.1644634 0.1561396 0.12531975 0.09889181 0.09307871 0.06889226
#> 7  0.17819985 0.1694550 0.1901292 0.23583673 0.19568133 0.12953228 0.18455627
#> 8  0.12240831 0.1746020 0.1399315 0.22870587 0.10856726 0.06673333 0.06914980
#> 9  0.19695773 0.1532392 0.1350918 0.09199823 0.18300561 0.08947953 0.14835145
#> 10 0.08922132 0.2036230 0.1305519 0.18336976 0.16278750 0.13619419 0.18144756
#>          1990       1991      1992      1993       1994       1995       1996
#> 1  0.10616757 0.10732627 0.1255960 0.1475999 0.09930163 0.10976590 0.10981507
#> 2  0.14918678 0.11929545 0.1172663 0.2120166 0.11589468 0.17138129 0.14573935
#> 3  0.09502841 0.11690515 0.1264083 0.1350495 0.15900153 0.06549947 0.07645027
#> 4  0.18446882 0.18021378 0.2243880 0.1503551 0.09337408 0.20193990 0.29182162
#> 5  0.11039822 0.17655727 0.1068025 0.0915205 0.25068911 0.15218659 0.13956686
#> 6  0.15761384 0.08725434 0.1286553 0.1119964 0.11302263 0.14937619 0.20378605
#> 7  0.15993695 0.10624849 0.1566618 0.2045648 0.17203275 0.14882192 0.06617270
#> 8  0.09887691 0.05473783 0.1255491 0.1580836 0.08862902 0.08519012 0.06818262
#> 9  0.14141794 0.25443716 0.1346742 0.1130490 0.17112731 0.23759289 0.20113019
#> 10 0.23062298 0.06383594 0.2300837 0.2253278 0.12403233 0.11921974 0.07951543
#>          1997      1998       1999       2000       2001       2002       2003
#> 1  0.10556369 0.1008429 0.09242194 0.07302784 0.09760707 0.09388278 0.06321257
#> 2  0.15795273 0.1433447 0.05531560 0.18732002 0.10146451 0.14195351 0.10476956
#> 3  0.13079573 0.1057241 0.09395923 0.14318204 0.10575894 0.06781574 0.11122617
#> 4  0.18611691 0.1975487 0.15691191 0.15940934 0.19322249 0.19746552 0.29719632
#> 5  0.07013101 0.1004922 0.13644514 0.11089345 0.16381907 0.09191490 0.14213737
#> 6  0.25031242 0.3347660 0.13149043 0.19295357 0.16079386 0.18277836 0.11068764
#> 7  0.24384176 0.1164686 0.12453326 0.18073621 0.19579660 0.23968737 0.18532650
#> 8  0.06281204 0.1500078 0.01833083 0.05586776 0.11004201 0.05292163 0.06943839
#> 9  0.15159899 0.1448195 0.21629461 0.09988054 0.09836671 0.15138150 0.13034926
#> 10 0.14650438 0.1924351 0.23515409 0.10858947 0.10694365 0.10286311 0.30367471
#>          2004       2005       2006       2007       2008       2009       2010
#> 1  0.08264809 0.09394910 0.10404765 0.05413852 0.08793467 0.07469367 0.13791233
#> 2  0.13779769 0.12899737 0.14945693 0.08748682 0.07894487 0.16093809 0.10895560
#> 3  0.06751833 0.06320633 0.05950030 0.08668646 0.10057198 0.12529453 0.11356708
#> 4  0.12489852 0.11692200 0.15898481 0.17817402 0.16077764 0.23411677 0.18155203
#> 5  0.09412642 0.05874342 0.08294860 0.15825394 0.11683841 0.14555956 0.07329740
#> 6  0.11758499 0.23587615 0.16283361 0.24647643 0.18070910 0.14169078 0.15696837
#> 7  0.10227266 0.15318578 0.16222940 0.15006558 0.23697384 0.20704204 0.17202452
#> 8  0.04215163 0.05918948 0.20430291 0.09663978 0.13952665 0.03555512 0.09847198
#> 9  0.09043056 0.04232765 0.07969163 0.18659471 0.22450154 0.13348763 0.06337745
#> 10 0.12289440 0.06902752 0.15162039 0.13524303 0.22373688 0.04146482 0.16077496
#>          2011       2012       2013       2014       2015       2016       2017
#> 1  0.05443160 0.09094195 0.05718425 0.05883321 0.09842247 0.02477818 0.04466057
#> 2  0.11550362 0.08644734 0.12321156 0.13732819 0.11434885 0.07785765 0.14892354
#> 3  0.09055143 0.15907633 0.14388516 0.10766125 0.09270225 0.01416956 0.02918792
#> 4  0.11632376 0.12575502 0.16131236 0.17979429 0.05443965 0.04368584 0.02999620
#> 5  0.17094535 0.14215785 0.16715702 0.07817143 0.18462142 0.09876799 0.11868061
#> 6  0.04224047 0.06088697 0.08135711 0.11718436 0.04942147 0.08813096 0.07261649
#> 7  0.08572613 0.11121192 0.19813499 0.02038484 0.06017988 0.12877912 0.02210604
#> 8  0.07066397 0.17188478 0.10207655 0.10502003 0.04133852 0.11057553 0.00000000
#> 9  0.09474993 0.06145922 0.08759652 0.06759184 0.02217154 0.11861235 0.14659796
#> 10 0.14421611 0.11136344 0.07142577 0.09798054 0.09641900 0.07737274 0.00000000
#>          2018       2019       2020       2021
#> 1  0.06570220 0.05862311 0.07565107 0.06188959
#> 2  0.18149319 0.18420470 0.06791706 0.11112490
#> 3  0.08092477 0.07822265 0.08652308 0.09437853
#> 4  0.10692741 0.17226175 0.04445955 0.09699209
#> 5  0.09401347 0.15578454 0.25129311 0.07309549
#> 6  0.08628531 0.15290770 0.14799152 0.07826798
#> 7  0.08755709 0.13541362 0.09829493 0.04765295
#> 8  0.05412992 0.08720416 0.10128052 0.04910036
#> 9  0.13548307 0.07483385 0.05432088 0.07900358
#> 10 0.10521165 0.08135887 0.05905731 0.05726145
```

``` r
## max per row
data_nM <- normalization(data, normty = "nM", sc = 1000)
head(data_nM$tdm, n=10)
#>     keyword tot_freq  int_freq zone      1965      1966      1967      1968
#> 1    effect     1528 [49-1528]   VH 0.6774851 0.6751091 0.6055686 0.8703776
#> 2    person      851 [49-1528]   VH 0.3427588 0.7643485 0.6406006 0.3963137
#> 3  behavior      668 [49-1528]   VH 0.4958264 0.5460186 0.3775351 0.7431635
#> 4      self      650 [49-1528]   VH 0.3253820 0.1209331 0.2027081 0.3762219
#> 5    social      575 [49-1528]   VH 0.6800808 0.5265879 0.7414402 0.6552843
#> 6     group      537 [49-1528]   VH 0.5878100 0.5340338 0.3906099 0.5537917
#> 7      role      441 [49-1528]   VH 0.0000000 0.2199365 0.2211946 0.6081961
#> 8   respons      428 [49-1528]   VH 0.5889201 0.5732597 0.6813641 0.7025540
#> 9     model      399 [49-1528]   VH 0.2193049 0.3396164 0.5464946 0.4226176
#> 10   affect      367 [49-1528]   VH 0.3485810 0.3598759 0.2895476 0.4478284
#>          1969      1970      1971       1972      1973      1974      1975
#> 1  0.78840981 0.8020031 1.0000000 0.90821126 0.7566657 0.8645913 0.8298846
#> 2  0.44289291 0.5264423 0.5127882 0.57645063 0.6003289 0.4471416 0.4478528
#> 3  0.66101695 1.0000000 0.5072046 0.61768835 0.4502924 0.7186933 0.4723926
#> 4  0.06006282 0.3180249 0.1497820 0.07296354 0.3419366 0.2476092 0.1328588
#> 5  0.54922553 0.2373942 0.4891552 0.28593946 0.3474146 0.4158707 0.4165321
#> 6  0.36168281 0.2735806 0.4509743 0.35149408 0.4118108 0.3408089 0.5440281
#> 7  0.00000000 0.1652514 0.3405036 0.72982820 0.4836745 0.4503176 0.3866004
#> 8  0.69884843 0.7048215 0.5809192 0.47164003 0.8350005 0.4115723 0.5839881
#> 9  0.60722790 0.7655224 0.6309493 0.86059472 0.2560695 0.4768190 0.3581831
#> 10 0.32172573 0.6489510 0.4680115 0.52110435 0.3391813 0.6315789 0.3795501
#>         1976      1977      1978       1979      1980      1981      1982
#> 1  0.7080748 0.7248374 0.6837839 0.71866177 0.5840063 0.6003653 0.4135328
#> 2  0.5044533 0.3551351 0.2273356 0.55750653 0.7001630 0.7762287 0.7841797
#> 3  0.5405405 0.8562162 0.3653979 0.65483029 0.6288867 0.4678639 0.6015625
#> 4  0.1596264 0.5056965 0.1618579 0.56995381 0.3127845 0.2947506 0.3383747
#> 5  0.6255658 0.6605974 0.4933528 0.31908754 0.4596685 0.3369068 0.5746299
#> 6  0.4998391 0.1015058 0.3248888 0.04903021 0.5179646 0.5324737 0.2445126
#> 7  0.1161226 0.4598456 0.5887296 0.74039537 0.5688494 0.7370713 0.3692336
#> 8  0.6191000 0.5448080 0.8370060 1.00000000 0.3538246 0.3810566 0.5686906
#> 9  0.4841412 0.1420147 1.0000000 0.61737479 0.4611562 0.3724867 0.3991083
#> 10 0.2280098 0.1504865 0.2889965 0.36344648 0.4886660 0.6578450 0.7854167
#>         1983      1984      1985      1986      1987      1988      1989
#> 1  0.4770563 0.5064570 0.4723518 0.5766837 0.4299935 0.4255527 0.5834211
#> 2  0.6530815 0.7973301 0.6971107 0.9423244 0.8339257 0.8761016 0.7406062
#> 3  0.3936382 0.3343183 0.3232125 0.4819193 0.2680747 0.1530612 0.2975952
#> 4  0.6199725 0.5265448 0.4326954 0.5421526 0.4749891 0.5062438 0.4687066
#> 5  0.7288898 0.7308214 0.4987370 0.4249323 0.7859464 0.5196026 0.6122772
#> 6  0.2613320 0.5152415 0.4291544 0.3591173 0.3050946 0.3048469 0.2352025
#> 7  0.6765124 0.6583549 0.6480575 0.8380936 0.7486654 0.5261065 0.7813842
#> 8  0.3206027 0.4679967 0.3290548 0.5607203 0.2865663 0.1869935 0.2019829
#> 9  0.6267847 0.4990598 0.3859852 0.2740549 0.5869212 0.3046467 0.5265076
#> 10 0.2767396 0.6463487 0.3635651 0.5324061 0.5088546 0.4519481 0.6276553
#>         1990      1991      1992      1993      1994      1995      1996
#> 1  0.3792650 0.4146899 0.4794584 0.5371101 0.3647353 0.3846574 0.4004081
#> 2  0.6907710 0.5974398 0.5802310 1.0000000 0.5517442 0.7784360 0.6887642
#> 3  0.2775701 0.3693341 0.3945652 0.4018265 0.4775194 0.1876777 0.2279230
#> 4  0.6193206 0.6544058 0.8050376 0.5142060 0.3223216 0.6650747 1.0000000
#> 5  0.4283079 0.7408771 0.4427918 0.3616919 1.0000000 0.5791968 0.5526705
#> 6  0.5265020 0.3152530 0.4592585 0.3810973 0.3881875 0.4894888 0.6948164
#> 7  0.6625501 0.4760572 0.6935171 0.8632311 0.7327427 0.6047732 0.2797942
#> 8  0.2825873 0.1692045 0.3834382 0.4602259 0.2604379 0.2388376 0.1988939
#> 9  0.4910790 0.9556392 0.4997530 0.3998893 0.6109937 0.8093494 0.7128762
#> 10 0.7805607 0.2336877 0.8321739 0.7768645 0.4316279 0.3958294 0.2746917
#>         1997      1998       1999      2000      2001      2002      2003
#> 1  0.3393090 0.3221435 0.34652834 0.2805417 0.3635979 0.3377706 0.2197058
#> 2  0.6580529 0.5935242 0.26882160 0.9327087 0.4898997 0.6619647 0.4719828
#> 3  0.3437500 0.2761506 0.28805237 0.4497445 0.3221258 0.1994962 0.3160920
#> 4  0.5622226 0.5930889 0.55291871 0.5755253 0.6764559 0.6676807 0.9707854
#> 5  0.2448128 0.3486417 0.55560341 0.4626558 0.6627469 0.3591409 0.5365245
#> 6  0.7523466 1.0000000 0.46101239 0.6931330 0.5600984 0.6149154 0.3597427
#> 7  0.9088828 0.4314514 0.54146208 0.8051432 0.8457933 1.0000000 0.7469554
#> 8  0.1615216 0.3833757 0.05498607 0.1717027 0.3279484 0.1523267 0.1930833
#> 9  0.4736670 0.4497043 0.78832515 0.3729802 0.3561921 0.5294252 0.4403953
#> 10 0.4461538 0.5824268 0.83535188 0.3952300 0.3774403 0.3506297 1.0000000
#>         2004      2005      2006      2007      2008      2009      2010
#> 1  0.3582552 0.3693955 0.3837753 0.2088055 0.2964006 0.2697870 0.5314478
#> 2  0.7742023 0.6574046 0.7145188 0.4373521 0.3449020 0.7534404 0.5442018
#> 3  0.2393038 0.2032020 0.1794454 0.2733728 0.2771815 0.3700306 0.3578313
#> 4  0.5088135 0.4320529 0.5511147 0.6458352 0.5093148 0.7947150 0.6575070
#> 5  0.4431129 0.2508426 0.3322744 0.6628776 0.4277083 0.5709802 0.3067533
#> 6  0.4766135 0.8672370 0.5616212 0.8889265 0.5695787 0.4785569 0.5656196
#> 7  0.5140889 0.6984518 0.6938942 0.6711750 0.9262716 0.8671909 0.7687177
#> 8  0.1461776 0.1861875 0.6028734 0.2981937 0.3762556 0.1027416 0.3035828
#> 9  0.3810403 0.1617779 0.2857284 0.6995697 0.7355873 0.4686776 0.2374042
#> 10 0.5047136 0.2571429 0.5298532 0.4942012 0.7145124 0.1418960 0.5869880
#>         2011      2012      2013      2014       2015       2016       2017
#> 1  0.1856382 0.3437813 0.2254833 0.2416996 0.39966576 0.10984634 0.18043605
#> 2  0.5105811 0.4235673 0.6297125 0.7312500 0.60184877 0.44737354 0.77985756
#> 3  0.2525108 0.4916905 0.4638978 0.3616438 0.30779480 0.05136187 0.09642075
#> 4  0.3728433 0.4467710 0.5977882 0.6941781 0.20775893 0.18201137 0.11389560
#> 5  0.6331647 0.5836224 0.7158231 0.3487743 0.81419405 0.47552734 0.52074122
#> 6  0.1347100 0.2152272 0.2999772 0.4501712 0.18766061 0.36534186 0.27433998
#> 7  0.3390381 0.4875153 0.9059790 0.0971135 0.28338251 0.66203446 0.10356882
#> 8  0.1928063 0.5198311 0.3220111 0.3451694 0.13429643 0.39217694 0.00000000
#> 9  0.3141168 0.2258401 0.3357537 0.2699253 0.08751741 0.51114255 0.57573544
#> 10 0.4659971 0.3988539 0.2668371 0.3813699 0.37095270 0.32498054 0.00000000
#>         2018      2019      2020      2021
#> 1  0.2276654 0.1930071 0.2509379 0.2793256
#> 2  0.8151365 0.7860643 0.2920000 0.6500660
#> 3  0.2292804 0.2105743 0.2346667 0.3482850
#> 4  0.3482153 0.5330096 0.1385983 0.4114065
#> 5  0.3537939 0.5570215 0.9052632 0.3582836
#> 6  0.2795817 0.4707481 0.4590317 0.3303179
#> 7  0.3518256 0.5169944 0.3780952 0.2494032
#> 8  0.1500588 0.2296934 0.2687719 0.1772902
#> 9  0.4563501 0.2394961 0.1751515 0.3466059
#> 10 0.3454094 0.2537830 0.1856000 0.2448549
```

``` r
## min-max per row
data_nmM <- normalization(data, normty = "nmM", sc = 1000)
head(data_nmM$tdm, n=10)
#>     keyword tot_freq  int_freq zone      1965       1966      1967      1968
#> 1    effect     1528 [49-1528]   VH 0.6376862 0.63501707 0.5568952 0.8543820
#> 2    person      851 [49-1528]   VH 0.1493833 0.69501441 0.5348571 0.2186953
#> 3  behavior      668 [49-1528]   VH 0.4685290 0.52143882 0.3438331 0.7292577
#> 4      self      650 [49-1528]   VH 0.2822734 0.06475995 0.1517605 0.3363619
#> 5    social      575 [49-1528]   VH 0.5804921 0.37921786 0.6609522 0.5479766
#> 6     group      537 [49-1528]   VH 0.5665583 0.51000949 0.3591909 0.5307860
#> 7      role      441 [49-1528]   VH 0.0000000 0.21993648 0.2211946 0.6081961
#> 8   respons      428 [49-1528]   VH 0.5889201 0.57325967 0.6813641 0.7025540
#> 9     model      399 [49-1528]   VH 0.1444274 0.27627817 0.5029983 0.3672401
#> 10   affect      367 [49-1528]   VH 0.3485810 0.35987590 0.2895476 0.4478284
#>         1969      1970       1971       1972      1973      1974      1975
#> 1  0.7622993 0.7775700 1.00000000 0.89688439 0.7266378 0.8478817 0.8088921
#> 2  0.2789792 0.3871107 0.36943925 0.45183266 0.4827365 0.2844779 0.2853983
#> 3  0.6426635 1.0000000 0.48052332 0.59698895 0.4205297 0.7034626 0.4438265
#> 4  0.0000000 0.2744461 0.09545233 0.01372508 0.2998857 0.1995308 0.0774477
#> 5  0.4089024 0.0000000 0.33013252 0.06365710 0.1442690 0.2340350 0.2349024
#> 6  0.3287724 0.2361278 0.42266761 0.31805834 0.3814848 0.3068223 0.5205191
#> 7  0.0000000 0.1652514 0.34050364 0.72982820 0.4836745 0.4503176 0.3866004
#> 8  0.6988484 0.7048215 0.58091916 0.47164003 0.8350005 0.4115723 0.5839881
#> 9  0.5695566 0.7430333 0.59555312 0.84722417 0.1847181 0.4266400 0.2966255
#> 10 0.3217257 0.6489510 0.46801153 0.52110435 0.3391813 0.6315789 0.3795501
#>         1976       1977      1978      1979      1980      1981      1982
#> 1  0.6720508 0.69088189 0.6447624 0.6839442 0.5326720 0.5510497 0.3411619
#> 2  0.3586521 0.16540105 0.0000000 0.4273148 0.6119440 0.7103901 0.7206804
#> 3  0.5156641 0.84843137 0.3310388 0.6361419 0.6087936 0.4390526 0.5799900
#> 4  0.1059258 0.47411003 0.1082998 0.5424735 0.2688708 0.2496846 0.2960963
#> 5  0.5090068 0.55494365 0.3356368 0.1071240 0.2914668 0.1304902 0.4422150
#> 6  0.4740518 0.05518112 0.2900813 0.0000000 0.4931118 0.5083689 0.2055611
#> 7  0.1161226 0.45984556 0.5887296 0.7403954 0.5688494 0.7370713 0.3692336
#> 8  0.6191000 0.54480797 0.8370060 1.0000000 0.3538246 0.3810566 0.5686906
#> 9  0.4346645 0.05972424 1.0000000 0.5806767 0.4094750 0.3123010 0.3414759
#> 10 0.2280098 0.15048649 0.2889965 0.3634465 0.4886660 0.6578450 0.7854167
#>         1983      1984      1985      1986      1987      1988      1989
#> 1  0.4125242 0.4455530 0.4072392 0.5244458 0.3596539 0.3546650 0.5320146
#> 2  0.5510101 0.7376999 0.6079937 0.9253549 0.7850628 0.8396478 0.6642866
#> 3  0.3608081 0.2982764 0.2865694 0.4538690 0.2284463 0.1072056 0.2595651
#> 4  0.5956884 0.4962906 0.3964442 0.5128957 0.4414404 0.4746923 0.4347565
#> 5  0.6444950 0.6470278 0.3426972 0.2459175 0.7193129 0.3700580 0.4915816
#> 6  0.2232477 0.4902483 0.3997227 0.3260746 0.2692666 0.2690062 0.1957710
#> 7  0.6765124 0.6583549 0.6480575 0.8380936 0.7486654 0.5261065 0.7813842
#> 8  0.3206027 0.4679967 0.3290548 0.5607203 0.2865663 0.1869935 0.2019829
#> 9  0.5909892 0.4510140 0.3270942 0.2044285 0.5473023 0.2379544 0.4810943
#> 10 0.2767396 0.6463487 0.3635651 0.5324061 0.5088546 0.4519481 0.6276553
#>         1990      1991      1992      1993      1994      1995      1996
#> 1  0.3026654 0.3424617 0.4152227 0.4799888 0.2863426 0.3087232 0.3264175
#> 2  0.5997887 0.4789974 0.4567253 1.0000000 0.4198570 0.7132468 0.5971914
#> 3  0.2384558 0.3351881 0.3617853 0.3694397 0.4492308 0.1436964 0.1861207
#> 4  0.5949949 0.6323220 0.7925794 0.4831633 0.2790174 0.6436727 1.0000000
#> 5  0.2503439 0.6602138 0.2693365 0.1629908 1.0000000 0.4482035 0.4134198
#> 6  0.5020893 0.2799488 0.4313789 0.3491879 0.3566436 0.4631678 0.6790817
#> 7  0.6625501 0.4760572 0.6935171 0.8632311 0.7327427 0.6047732 0.2797942
#> 8  0.2825873 0.1692045 0.3834382 0.4602259 0.2604379 0.2388376 0.1988939
#> 9  0.4422677 0.9513845 0.4517736 0.3423319 0.5736835 0.7910639 0.6853377
#> 10 0.7805607 0.2336877 0.8321739 0.7768645 0.4316279 0.3958294 0.2746917
#>          1997      1998       1999      2000      2001      2002      2003
#> 1  0.25777871 0.2384950 0.26588892 0.1917594 0.2850649 0.2560504 0.1234163
#> 2  0.55744417 0.4739296 0.05369209 0.9129100 0.3398164 0.5625070 0.3166279
#> 3  0.30821883 0.2369594 0.24950558 0.4199521 0.2854238 0.1561548 0.2790633
#> 4  0.53424827 0.5670869 0.52434982 0.5484010 0.6557811 0.6464452 0.9689186
#> 5  0.00972792 0.1458781 0.41726567 0.2953841 0.5577622 0.1596457 0.3922476
#> 6  0.73957807 1.0000000 0.43322321 0.6773115 0.5374179 0.5950612 0.3267323
#> 7  0.90888278 0.4314514 0.54146208 0.8051432 0.8457933 1.0000000 0.7469554
#> 8  0.16152159 0.3833757 0.05498607 0.1717027 0.3279484 0.1523267 0.1930833
#> 9  0.42318566 0.3969248 0.76802314 0.3128419 0.2944436 0.4842918 0.3867229
#> 10 0.44615385 0.5824268 0.83535188 0.3952300 0.3774403 0.3506297 1.0000000
#>         2004       2005      2006      2007      2008      2009       2010
#> 1  0.2790629 0.29157794 0.3077322 0.1111709 0.2095753 0.1796776 0.47362776
#> 2  0.7077674 0.55660509 0.6305236 0.2718081 0.1521571 0.6808968 0.41009549
#> 3  0.1981177 0.16006114 0.1350183 0.2340312 0.2380461 0.3359223 0.32306255
#> 4  0.4774263 0.39576054 0.5224306 0.6232038 0.4779595 0.7815971 0.63562134
#> 5  0.2697575 0.01763485 0.1244158 0.5579336 0.2495577 0.4374292 0.09095019
#> 6  0.4496287 0.86039197 0.5390192 0.8831997 0.5473870 0.4516722 0.54322379
#> 7  0.5140889 0.69845179 0.6938942 0.6711750 0.9262716 0.8671909 0.76871773
#> 8  0.1461776 0.18618745 0.6028734 0.2981937 0.3762556 0.1027416 0.30358275
#> 9  0.3216750 0.08138288 0.2172217 0.6707550 0.7102272 0.4177178 0.16426259
#> 10 0.5047136 0.25714286 0.5298532 0.4942012 0.7145124 0.1418960 0.58698795
#>          2011      2012      2013      2014      2015      2016       2017
#> 1  0.08514470 0.2628029 0.1299067 0.1481241 0.3255836 0.0000000 0.07930059
#> 2  0.36658274 0.2539676 0.5207653 0.6521776 0.4847035 0.2847781 0.71508659
#> 3  0.21203964 0.4641693 0.4348717 0.3270815 0.2703169 0.0000000 0.04749849
#> 4  0.33276745 0.4114192 0.5720865 0.6746358 0.1571340 0.1297412 0.05727274
#> 5  0.51897127 0.4540068 0.6273607 0.1460521 0.7563539 0.3122624 0.37155111
#> 6  0.09009726 0.1747658 0.2638853 0.4218231 0.1457779 0.3326201 0.23692631
#> 7  0.33903805 0.4875153 0.9059790 0.0971135 0.2833825 0.6620345 0.10356882
#> 8  0.19280626 0.5198311 0.3220111 0.3451694 0.1342964 0.3921769 0.00000000
#> 9  0.24833281 0.1515894 0.2720450 0.1999028 0.0000000 0.4642556 0.53504367
#> 10 0.46599713 0.3988539 0.2668371 0.3813699 0.3709527 0.3249805 0.00000000
#>         2018       2019       2020      2021
#> 1  0.1323581 0.09342296 0.15850243 0.1903933
#> 2  0.7607454 0.72311945 0.08369010 0.5471073
#> 3  0.1875515 0.16783262 0.19322942 0.3129993
#> 4  0.3065657 0.50316851 0.08355396 0.3737949
#> 5  0.1526342 0.41912526 0.87577220 0.1585215
#> 6  0.2424383 0.44346091 0.43114044 0.2957903
#> 7  0.3518256 0.51699440 0.37809524 0.2494032
#> 8  0.1500588 0.22969342 0.26877193 0.1772902
#> 9  0.4042079 0.16655522 0.09603921 0.2839380
#> 10 0.3454094 0.25378304 0.18560000 0.2448549
```

``` r
## nonlinear normalization (based on asymmetry)
data_nnl <- normalization(data, normty = "nnl", sc = 1000, nnlty="CT")
head(data_nnl$p_asy, n=10)
#>  [1] 0.6346395 0.4555481 0.5863061 0.4405269 0.5018079 0.4712548 0.4169522
#>  [8] 0.6176556 0.5237504 0.6217474

head(data_nnl$tdm, n=10)
#>     keyword tot_freq  int_freq zone      1965      1966      1967      1968
#> 1    effect     1528 [49-1528]   VH 0.7535262 0.7513777 0.6858403 0.9106473
#> 2    person      851 [49-1528]   VH 0.1281155 0.6559708 0.4903453 0.1897609
#> 3  behavior      668 [49-1528]   VH 0.5554375 0.6069534 0.4261583 0.7924201
#> 4      self      650 [49-1528]   VH 0.2364509 0.0517036 0.1234796 0.2852487
#> 5    social      575 [49-1528]   VH 0.5822521 0.3809217 0.6625709 0.5497672
#> 6     group      537 [49-1528]   VH 0.5381047 0.4812427 0.3331471 0.5020480
#> 7      role      441 [49-1528]   VH 0.0000000 0.1677952 0.1688196 0.5260859
#> 8   respons      428 [49-1528]   VH 0.6982782 0.6845524 0.7755043 0.7923417
#> 9     model      399 [49-1528]   VH 0.1565770 0.2956861 0.5267411 0.3895981
#> 10   affect      367 [49-1528]   VH 0.4679662 0.4802775 0.4011657 0.5713897
#>         1969      1970       1971       1972      1973      1974       1975
#> 1  0.8478064 0.8586028 1.00000000 0.93792046 0.8219775 0.9063834 0.88027107
#> 2  0.2445656 0.3457549 0.32895803 0.40816725 0.4384735 0.2496209 0.25046802
#> 3  0.7182220 1.0000000 0.56728185 0.67735666 0.5070287 0.7707511 0.53072858
#> 4  0.0000000 0.2294880 0.07671563 0.01083871 0.2522089 0.1640698 0.06200294
#> 5  0.4106514 0.0000000 0.33173369 0.06408950 0.1451641 0.2353339 0.23620457
#> 6  0.3038882 0.2159992 0.39485727 0.29363032 0.3547193 0.2828992 0.49175440
#> 7  0.0000000 0.1240135 0.26966001 0.65891291 0.4011627 0.3694248 0.31068424
#> 8  0.7894195 0.7941253 0.69129001 0.59050359 0.8910100 0.5304971 0.69397647
#> 9  0.5926945 0.7607631 0.61823030 0.85912809 0.1994669 0.4500423 0.31683711
#> 10 0.4380991 0.7523907 0.59117936 0.64139855 0.4576088 0.7380713 0.50137839
#>          1976       1977      1978      1979      1980      1981      1982
#> 1  0.78068241 0.79517690 0.7591943 0.7898680 0.6644184 0.6807206 0.4735377
#> 2  0.31875534 0.14223415 0.0000000 0.3843574 0.5688628 0.6723870 0.6834259
#> 3  0.60142184 0.88805903 0.4122251 0.7124624 0.6880374 0.5259038 0.6618274
#> 4  0.08532714 0.41515949 0.0872846 0.4828269 0.2245434 0.2076220 0.2488078
#> 5  0.51081400 0.55672898 0.3372512 0.1078176 0.2929625 0.1313129 0.4439995
#> 6  0.44546923 0.04947814 0.2669609 0.0000000 0.4643947 0.4796040 0.1873990
#> 7  0.08588327 0.37841952 0.5058544 0.6710034 0.4854693 0.6671902 0.2950871
#> 8  0.72418952 0.65910838 0.8924224 1.0000000 0.4693733 0.4986359 0.6805108
#> 9  0.45815518 0.06529217 1.0000000 0.6036329 0.4326462 0.3330749 0.3631657
#> 10 0.32681822 0.22551376 0.4005220 0.4841392 0.6110262 0.7596346 0.8574766
#>         1983      1984      1985      1986      1987      1988      1989
#> 1  0.5494955 0.5826150 0.5440808 0.6570181 0.4938267 0.4883962 0.6638294
#> 2  0.5066182 0.7017761 0.5647858 0.9120683 0.7534577 0.8141692 0.6234405
#> 3  0.4444447 0.3759433 0.3627638 0.5408253 0.2955896 0.1454315 0.3319199
#> 4  0.5370589 0.4368732 0.3408908 0.4532793 0.3835890 0.4157266 0.3771896
#> 5  0.6461502 0.6486776 0.3443280 0.2472610 0.7207706 0.3717454 0.4933891
#> 6  0.2039239 0.4615462 0.3724481 0.3013029 0.2472274 0.2469811 0.1782797
#> 7  0.5992863 0.5794886 0.5683725 0.7873146 0.6805302 0.4425606 0.7187872
#> 8  0.4325649 0.5869621 0.4420481 0.6734202 0.3935271 0.2709010 0.2902155
#> 9  0.6137563 0.4746464 0.3483537 0.2203258 0.5707348 0.2556211 0.5048534
#> 10 0.3861035 0.7502600 0.4842672 0.6517586 0.6300413 0.5754613 0.7348056
#>         1990      1991      1992      1993      1994      1995      1996
#> 1  0.4298495 0.4749783 0.5522477 0.6158771 0.4107075 0.4368582 0.4570410
#> 2  0.5563364 0.4347890 0.4129432 1.0000000 0.3771556 0.6754473 0.5536670
#> 3  0.3073690 0.4167580 0.4454905 0.4536571 0.5361710 0.1921335 0.2447704
#> 4  0.5363431 0.5752166 0.7505448 0.4239947 0.2335515 0.5871793 1.0000000
#> 5  0.2517035 0.6618342 0.2707620 0.1639797 1.0000000 0.4499927 0.4151746
#> 6  0.4733377 0.2573431 0.4033959 0.3235032 0.3306892 0.4346991 0.6534971
#> 7  0.5840403 0.3938537 0.6180586 0.8186299 0.6622384 0.5225088 0.2174174
#> 8  0.3888724 0.2475604 0.5011573 0.5793672 0.3626029 0.3363833 0.2862612
#> 9  0.4658308 0.9555979 0.4754114 0.3640459 0.5967567 0.8063434 0.7054704
#> 10 0.8539482 0.3338925 0.8907169 0.8512525 0.5552138 0.5185161 0.3836757
#>          1997      1998       1999      2000      2001      2002      2003
#> 1  0.37627872 0.3523384 0.38617737 0.2918438 0.4091930 0.3741565 0.1965029
#> 2  0.51312633 0.4298031 0.04532204 0.8976533 0.3010315 0.5182580 0.2793697
#> 3  0.38704660 0.3056137 0.32026917 0.5064361 0.3614680 0.2077724 0.3542529
#> 4  0.47456799 0.5077373 0.46467210 0.4887989 0.6000145 0.5901114 0.9608549
#> 5  0.00979783 0.1467814 0.41902509 0.2968914 0.5595452 0.1606183 0.3939729
#> 6  0.71680514 1.0000000 0.40520580 0.6516582 0.5087101 0.5670488 0.3019330
#> 7  0.87704844 0.3517788 0.45783352 0.7471477 0.7968438 1.0000000 0.6785557
#> 8  0.23733602 0.5010912 0.08591930 0.2508661 0.4408114 0.2249833 0.2787864
#> 9  0.44654603 0.4198908 0.78452872 0.3336343 0.3145730 0.5080543 0.4094994
#> 10 0.56972977 0.6962947 0.89292894 0.5178902 0.4991362 0.4702102 1.0000000
#>         2004       2005      2006      2007      2008      2009       2010
#> 1  0.4020472 0.41688836 0.4357151 0.1784824 0.3153306 0.2756064 0.60982711
#> 2  0.6695803 0.51227674 0.5881167 0.2379872 0.1305550 0.6409795 0.36775756
#> 3  0.2593432 0.21264462 0.1811490 0.3021731 0.3068887 0.4175587 0.40347249
#> 4  0.4183914 0.34024893 0.4627588 0.5656550 0.4189116 0.7380724 0.57868696
#> 5  0.2711844 0.01776057 0.1252057 0.5597165 0.2509144 0.4392095 0.09154985
#> 6  0.4213390 0.84598368 0.5103203 0.8707918 0.5187439 0.4233529 0.51455086
#> 7  0.4307168 0.62354883 0.6184775 0.5934405 0.8998430 0.8236172 0.70386838
#> 8  0.2166509 0.26985336 0.7103453 0.4070185 0.4935347 0.1561026 0.41321623
#> 9  0.3427617 0.08877934 0.2338214 0.6914005 0.7293961 0.4410071 0.17773415
#> 10 0.6261714 0.36264552 0.6494282 0.6162770 0.8044548 0.2137179 0.70025225
#>          2011      2012      2013       2014      2015      2016       2017
#> 1  0.13916516 0.3824225 0.2059340 0.23197052 0.4560993 0.0000000 0.13014067
#> 2  0.32625257 0.2216907 0.4762256 0.61072159 0.4404137 0.2498972 0.67741993
#> 3  0.27608631 0.5511076 0.5216650 0.40788899 0.3442753 0.0000000 0.06600886
#> 4  0.28196840 0.3550016 0.5128335 0.62015447 0.1280030 0.1050555 0.04565222
#> 5  0.52077628 0.4557999 0.6290497 0.14695629 0.7576840 0.3138175 0.37324124
#> 6  0.08109541 0.1587807 0.2421406 0.39403040 0.1320201 0.3075781 0.21674898
#> 7  0.26837527 0.4048621 0.8732716 0.07142429 0.2204506 0.5834801 0.07631633
#> 8  0.27842884 0.6362154 0.4341508 0.45990335 0.2003860 0.5103582 0.00000000
#> 9  0.26650056 0.1642258 0.2912752 0.21554351 0.0000000 0.4879652 0.55859903
#> 10 0.58922200 0.5216686 0.3743130 0.50330843 0.4922106 0.4417644 0.00000000
#>         2018      2019       2020      2021
#> 1  0.2094746 0.1518240 0.24652346 0.2900205
#> 2  0.7268089 0.6860485 0.07099450 0.5026778
#> 3  0.2465156 0.2222935 0.25342176 0.3923563
#> 4  0.2582186 0.4436530 0.06697989 0.3197340
#> 5  0.1535719 0.4208869 0.87655682 0.1594885
#> 6  0.2219281 0.4152665 0.40316192 0.2723894
#> 7  0.2796251 0.4335716 0.30302412 0.1919956
#> 8  0.2219168 0.3250996 0.37255932 0.2582266
#> 9  0.4272967 0.1801743 0.10461600 0.3036583
#> 10 0.4644830 0.3585726 0.27251772 0.3476755
```

``` r
curveCtu_nchi <- curveCtuPlot(data_nchi,
                              ctu_noun = c("person", "object", "instruct", "incident"),
                              r = 1,
                              themety = "light",
                              size_class = NULL,
                              x_lab = "year")
curveCtu_nchi
```

<img src="man/figures/README-unnamed-chunk-13-1.png" width="100%" />

``` r
curve_nchi <- curvePlot(data = data_nchi,
           r = 1,
           themety = "light",
           size_class = NULL,
           x_leg = 0.85,
           x_lab = "years"
)
curve_nchi
```

<img src="man/figures/README-unnamed-chunk-14-1.png" width="100%" />

``` r
facet_plot <- facetPlot(data, keyword_selection = list(type="frequency", n=3, kw.list=NULL),
                       r = 4, scales = "free", leg = TRUE, themety = "light",
                       size_class = NULL, x_lab = "year")
facet_plot
```

<img src="man/figures/README-unnamed-chunk-15-1.png" width="100%" />

``` r
## Smoothing selection - P m-2
p_m2 <- smoothingSelection(data_nchi,
                                lambda_seq = NULL,
                                degrees = NULL,
                                penalty_type = "m-2",
                                plot = TRUE,
                                verbose = TRUE)
#> Processing degree m = 1
#> Processing degree m = 2
#> Processing degree m = 3
#> Processing degree m = 4
#> Processing degree m = 5
#> Processing degree m = 6
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 106100793.040796 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 106100793.040796 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 106100793.040796 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 106100793.040796 to prevent overflow
#> Processing degree m = 7
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 2478303.51172501 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 2478303.51172501 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 2478303.51172501 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 2478303.51172501 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 2478303.51172501 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 2478303.51172501 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 2478303.51172501 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 2478303.51172501 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 2478303.51172501 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 2478303.51172501 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 2478303.51172501 to prevent overflow
#> Processing degree m = 8
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
#> Warning in smooth.basis1(argvals, y, fdParobj, wtvec = wtvec, fdnames =
#> fdnames, : lambda reduced to 45381.8066035005 to prevent overflow
p_m2$plots
#> $df
```

<img src="man/figures/README-unnamed-chunk-16-1.png" width="100%" />

    #> 
    #> $sse

<img src="man/figures/README-unnamed-chunk-16-2.png" width="100%" />

    #> 
    #> $gcv

<img src="man/figures/README-unnamed-chunk-16-3.png" width="100%" />

    #> 
    #> $ocv

<img src="man/figures/README-unnamed-chunk-16-4.png" width="100%" />

``` r
p_m2$summary_panel
```

<img src="man/figures/README-unnamed-chunk-16-5.png" width="100%" />

``` r
## Smoothing selection - P 2

p_2 <- smoothingSelection(data_nchi,
                            lambda_seq = NULL,
                            degrees = NULL,
                            penalty_type = "2",
                            plot = TRUE,
                            verbose = TRUE)
#> Processing degree m = 1
#> Processing degree m = 2
#> Processing degree m = 3
#> Processing degree m = 4
#> Processing degree m = 5
#> Processing degree m = 6
#> Processing degree m = 7
#> Processing degree m = 8

p_2$plots
#> $df
```

<img src="man/figures/README-unnamed-chunk-17-1.png" width="100%" />

    #> 
    #> $sse

<img src="man/figures/README-unnamed-chunk-17-2.png" width="100%" />

    #> 
    #> $gcv

<img src="man/figures/README-unnamed-chunk-17-3.png" width="100%" />

    #> 
    #> $ocv

<img src="man/figures/README-unnamed-chunk-17-4.png" width="100%" />

``` r
p_2$summary_panel
```

<img src="man/figures/README-unnamed-chunk-17-5.png" width="100%" />

``` r
## Smoothing selection - P 1

p_1 <- smoothingSelection(data_nchi,
                           lambda_seq = NULL,
                           degrees = NULL,
                           penalty_type = "1",
                           plot = TRUE,
                           verbose = TRUE)
#> Processing degree m = 1
#> Processing degree m = 2
#> Processing degree m = 3
#> Processing degree m = 4
#> Processing degree m = 5
#> Processing degree m = 6
#> Processing degree m = 7
#> Processing degree m = 8

p_1$plots
#> $df
```

<img src="man/figures/README-unnamed-chunk-18-1.png" width="100%" />

    #> 
    #> $sse

<img src="man/figures/README-unnamed-chunk-18-2.png" width="100%" />

    #> 
    #> $gcv

<img src="man/figures/README-unnamed-chunk-18-3.png" width="100%" />

    #> 
    #> $ocv

<img src="man/figures/README-unnamed-chunk-18-4.png" width="100%" />

``` r
p_1$summary_panel
```

<img src="man/figures/README-unnamed-chunk-18-5.png" width="100%" />

``` r
## Smoothing selection - P 0

p_0 <- smoothingSelection(data_nchi,
                           lambda_seq = NULL,
                           degrees = NULL,
                           penalty_type = "0",
                           normty = "nchi",
                           plot = TRUE,
                           verbose = TRUE)
#> Processing degree m = 1
#> Processing degree m = 2
#> Processing degree m = 3
#> Processing degree m = 4
#> Processing degree m = 5
#> Processing degree m = 6
#> Processing degree m = 7
#> Processing degree m = 8

p_0$plots
#> $df
```

<img src="man/figures/README-unnamed-chunk-19-1.png" width="100%" />

    #> 
    #> $sse

<img src="man/figures/README-unnamed-chunk-19-2.png" width="100%" />

    #> 
    #> $gcv

<img src="man/figures/README-unnamed-chunk-19-3.png" width="100%" />

    #> 
    #> $ocv

<img src="man/figures/README-unnamed-chunk-19-4.png" width="100%" />

``` r
p_0$summary_panel
```

<img src="man/figures/README-unnamed-chunk-19-5.png" width="100%" />

``` r
# Optimal Smoothing selection

resSmoothing <- list("m-2" = p_m2,
                     "2"   = p_2,
                     "1"   = p_1,
                     "0"   = p_0)

opt_res <- optimalSmoothing(resSmoothing)

# Results
opt_res$m_opt         # optimal degree
#> [1] 3
opt_res$penalty_opt   # optimal penality
#> [1] "1"
opt_res$gcv_matrix    # GCV array
#>            1        2        3        4        5        6        7        8
#> m-2 0.071167 0.071398 0.050666 0.051086 0.051463 0.051775 0.053073 0.056457
#> 2   0.071167 0.071398 0.050666 0.051086 0.051086 0.051086 0.051086 0.051086
#> 1   0.071167 0.071398 0.050666 0.050664 0.050667 0.050664 0.050668 0.050665
#> 0   0.071167 0.071398 0.068790 0.071398 0.071018 0.071387 0.071357 0.071395
opt_res$plots$gcv     # plots
```

<img src="man/figures/README-unnamed-chunk-20-1.png" width="100%" />

``` r
opt_res$plots$ocv
```

<img src="man/figures/README-unnamed-chunk-20-2.png" width="100%" />

``` r
opt_res$plots$df
```

<img src="man/figures/README-unnamed-chunk-20-3.png" width="100%" />

``` r
opt_res$plots$sse
```

<img src="man/figures/README-unnamed-chunk-20-4.png" width="100%" />

``` r
#######
   plot_opt <- plotOptimalSmoothing(data_nchi, opt_result = opt_res)
   plot_opt
```

<img src="man/figures/README-unnamed-chunk-21-1.png" width="100%" />

``` r
plotSubOpt <- plotSuboptimalFits(data=data_nchi,
                               opt_res=opt_res,
                               n_curves = 9,
                               show_zone = TRUE,
                               graph = FALSE)
plotSubOpt
#> $singleKeywordPlot
#> $singleKeywordPlot$effect
```

<img src="man/figures/README-unnamed-chunk-22-1.png" width="100%" />

    #> 
    #> $singleKeywordPlot$attach

<img src="man/figures/README-unnamed-chunk-22-2.png" width="100%" />

    #> 
    #> $singleKeywordPlot$effort

<img src="man/figures/README-unnamed-chunk-22-3.png" width="100%" />

    #> 
    #> $singleKeywordPlot$convers

<img src="man/figures/README-unnamed-chunk-22-4.png" width="100%" />

    #> 
    #> $singleKeywordPlot$organ

<img src="man/figures/README-unnamed-chunk-22-5.png" width="100%" />

    #> 
    #> $singleKeywordPlot$agenc

<img src="man/figures/README-unnamed-chunk-22-6.png" width="100%" />

    #> 
    #> $singleKeywordPlot$`social desir`

<img src="man/figures/README-unnamed-chunk-22-7.png" width="100%" />

    #> 
    #> $singleKeywordPlot$selv

<img src="man/figures/README-unnamed-chunk-22-8.png" width="100%" />

    #> 
    #> $singleKeywordPlot$psychosoci

<img src="man/figures/README-unnamed-chunk-22-9.png" width="100%" />

    #> 
    #> $singleKeywordPlot$`riski shift`

<img src="man/figures/README-unnamed-chunk-22-10.png" width="100%" />

    #> 
    #> 
    #> $combinedKeywordPlot

<img src="man/figures/README-unnamed-chunk-22-11.png" width="100%" />
